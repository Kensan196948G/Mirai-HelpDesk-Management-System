# Dashboard コンポーネント

## 概要
Mirai ヘルプデスク管理システムのダッシュボード画面です。チケット統計、優先度別の分布、SLA期限超過アラート、最近のチケット一覧を表示します。

## ファイル構成
- `Dashboard.tsx` - メインコンポーネント
- `Dashboard.css` - スタイルシート

## 主な機能

### 1. チケット統計カード
4つの主要な統計を表示:
- 総チケット数
- 新規チケット数
- 対応中チケット数
- 解決済チケット数

### 2. 優先度別チケット数
P1（全社停止）からP4（問い合わせ）までの優先度別にチケット数を表示します。

### 3. SLA統計
- 期限超過チケット数
- 平均初動時間（オプション）
- 平均解決時間（オプション）

### 4. SLA期限超過アラート
期限を超過したチケットがある場合、画面上部に警告アラートを表示します。
- 超過チケット数の表示
- 最大3件のチケット詳細をプレビュー
- チケット番号クリックで詳細画面へ遷移

### 5. 最近のチケット一覧
最新の5件のチケットをテーブル形式で表示:
- チケット番号
- 件名
- タイプ
- 優先度
- ステータス
- 作成日時

行クリックでチケット詳細画面へ遷移します。

## データ取得

### API エンドポイント

#### チケット統計取得
```
GET /tickets/statistics
```

レスポンス例:
```json
{
  "success": true,
  "data": {
    "statistics": {
      "total": 150,
      "new": 12,
      "in_progress": 35,
      "resolved": 80,
      "closed": 23,
      "by_priority": {
        "P1": 2,
        "P2": 15,
        "P3": 50,
        "P4": 83
      },
      "by_status": {
        "new": 12,
        "triage": 5,
        "assigned": 8,
        "in_progress": 35,
        "pending_customer": 10,
        "pending_approval": 5,
        "resolved": 80,
        "closed": 23
      },
      "sla_overdue": 3,
      "avg_response_time_hours": 2.5,
      "avg_resolution_time_hours": 24.3
    }
  }
}
```

#### 最近のチケット取得
```
GET /tickets?pageSize=5
```

レスポンス例:
```json
{
  "success": true,
  "data": {
    "tickets": [
      {
        "ticket_id": "123e4567-e89b-12d3-a456-426614174000",
        "ticket_number": "TKT-2024-0001",
        "type": "incident",
        "subject": "メールが送信できない",
        "status": "in_progress",
        "priority": "P2",
        "requester_name": "山田太郎",
        "assignee_name": "佐藤花子",
        "created_at": "2024-01-20T10:30:00Z"
      }
    ]
  }
}
```

## React Query

### 自動リフレッシュ
- チケット統計: 30秒ごと
- 最近のチケット: 30秒ごと
- 期限超過チケット: 60秒ごと

### キャッシュキー
- `['ticketStatistics']` - 統計データ
- `['recentTickets']` - 最近のチケット
- `['overdueTickets']` - 期限超過チケット

## 使用コンポーネント（Ant Design）

- `Card` - 統計カードとセクション表示
- `Statistic` - 数値統計の表示
- `Row`, `Col` - グリッドレイアウト
- `Table` - チケット一覧表示
- `Tag` - ステータス、優先度、タイプの表示
- `Alert` - SLA期限超過の警告表示
- `Badge` - 優先度別のステータス表示
- `Spin` - ローディング表示
- `Typography` - テキスト表示

## ナビゲーション

### チケット詳細へ遷移
```typescript
navigate(`/tickets/${ticket.ticket_id}`)
```

### チケット一覧へ遷移
```typescript
navigate('/tickets')
```

## エラーハンドリング

### ローディング状態
データ取得中は中央にスピナーを表示します。

### エラー状態
データ取得に失敗した場合、エラーメッセージをAlertコンポーネントで表示します。

### データが空の場合
統計データやチケットが存在しない場合、デフォルト値（0件）を表示します。

## スタイリング

### レスポンシブデザイン
- デスクトップ: 4列グリッド
- タブレット: 2列グリッド
- モバイル: 1列グリッド

### カラーテーマ
- 背景色: `#f0f2f5`
- カード影: `0 2px 8px rgba(0, 0, 0, 0.08)`
- ホバー効果: 上方向に2px移動

### アニメーション
- アラート: スライドダウン（0.3秒）
- カードホバー: トランジション（0.3秒）

## 型定義

型定義は `@types/index.ts` に集約されています:

```typescript
export interface TicketStatistics {
  total: number;
  new: number;
  in_progress: number;
  resolved: number;
  closed: number;
  by_priority: {
    P1: number;
    P2: number;
    P3: number;
    P4: number;
  };
  by_status: Record<string, number>;
  sla_overdue: number;
  avg_response_time_hours?: number;
  avg_resolution_time_hours?: number;
}
```

## テスト観点

### 表示確認
- [ ] 統計カードが正しく表示される
- [ ] 優先度別チケット数が正しく表示される
- [ ] SLA統計が正しく表示される
- [ ] 最近のチケット一覧が表示される

### データ取得
- [ ] API呼び出しが正しく行われる
- [ ] ローディング状態が表示される
- [ ] エラー時にエラーメッセージが表示される
- [ ] 自動リフレッシュが機能する

### インタラクション
- [ ] チケット行クリックで詳細画面へ遷移する
- [ ] アラート内のチケット番号クリックで詳細画面へ遷移する
- [ ] 「すべて表示」リンクでチケット一覧画面へ遷移する

### SLA期限超過アラート
- [ ] 期限超過チケットがある場合のみ表示される
- [ ] 期限超過チケット数が正しく表示される
- [ ] 最大3件のチケット詳細が表示される
- [ ] 3件を超える場合「他N件...」が表示される

### レスポンシブ
- [ ] モバイル表示で適切にレイアウトされる
- [ ] タブレット表示で適切にレイアウトされる
- [ ] デスクトップ表示で適切にレイアウトされる

## 改善提案

### 短期
- [ ] チャートライブラリ（Chart.js、Recharts等）を導入して視覚的な統計表示
- [ ] カスタム日付範囲での統計表示
- [ ] エクスポート機能（CSV、PDF）

### 中期
- [ ] リアルタイム更新（WebSocket）
- [ ] ダッシュボードのカスタマイズ機能
- [ ] ウィジェットのドラッグ&ドロップ

### 長期
- [ ] 予測分析とトレンド表示
- [ ] AIによる異常検知とアラート
- [ ] 複数ダッシュボードの作成と切り替え
