/**
 * ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿å®Œå…¨ç‰ˆï¼‰
 */

const pages = {
    dashboard: async () => {
        const total = SAMPLE_TICKETS.length;
        const newTickets = SAMPLE_TICKETS.filter(t => t.status === 'New').length;
        const inProgress = SAMPLE_TICKETS.filter(t => t.status === 'In Progress').length;
        const resolved = SAMPLE_TICKETS.filter(t => t.status === 'Resolved').length;
        const aiProcessed = SAMPLE_TICKETS.filter(t => t.ai_processed).length;

        return `
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">å…¨ãƒã‚±ãƒƒãƒˆ</div>
                    <div class="stat-value" style="color: var(--primary);">${total}</div>
                    <div class="stat-trend">ğŸ“ˆ å‰é€±æ¯” +12%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">æ–°è¦</div>
                    <div class="stat-value" style="color: var(--warning);">${newTickets}</div>
                    <div class="stat-trend">ğŸ”¥ å¯¾å¿œå¾…ã¡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">å¯¾å¿œä¸­</div>
                    <div class="stat-value" style="color: #722ed1;">${inProgress}</div>
                    <div class="stat-trend">âš¡ å‡¦ç†ä¸­</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">è§£æ±ºæ¸ˆã¿</div>
                    <div class="stat-value" style="color: var(--success);">${resolved}</div>
                    <div class="stat-trend">âœ… å®Œäº†</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ¤– ãƒãƒ«ãƒAIçµ±è¨ˆ</h3>
                </div>
                <div class="stats-grid" style="grid-template-columns: repeat(3, 1fr);">
                    <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                        <div class="stat-label" style="color: rgba(255,255,255,0.9);">AIå‡¦ç†æ¸ˆã¿ãƒã‚±ãƒƒãƒˆ</div>
                        <div class="stat-value">${aiProcessed}</div>
                        <div class="stat-trend" style="color: rgba(255,255,255,0.9);">ğŸ“Š ç·ãƒã‚±ãƒƒãƒˆã®${AI_STATS.aiProcessingRate}%</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
                        <div class="stat-label" style="color: rgba(255,255,255,0.9);">AIè‡ªå‹•ç”ŸæˆãƒŠãƒ¬ãƒƒã‚¸</div>
                        <div class="stat-value">${AI_STATS.autoGeneratedKnowledge}</div>
                        <div class="stat-trend" style="color: rgba(255,255,255,0.9);">âœ¨ å“è³ªã‚¹ã‚³ã‚¢å¹³å‡ ${AI_STATS.averageQualityScore}%</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white;">
                        <div class="stat-label" style="color: rgba(255,255,255,0.9);">è‡ªå‹•åŒ–æˆåŠŸç‡</div>
                        <div class="stat-value">${AI_STATS.automationSuccessRate}%</div>
                        <div class="stat-trend" style="color: rgba(255,255,255,0.9);">ğŸ¯ å¹³å‡å‡¦ç†: ${AI_STATS.averageProcessingTime}ç§’</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">æœ€è¿‘ã®ãƒã‚±ãƒƒãƒˆ</h3>
                    <button class="btn btn-primary" onclick="navigateTo('tickets')">ã™ã¹ã¦è¡¨ç¤º</button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>ç¨®åˆ¥</th>
                                <th>ä»¶å</th>
                                <th>å„ªå…ˆåº¦</th>
                                <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                                <th>ITSM</th>
                                <th>AI</th>
                                <th>ä½œæˆ</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${SAMPLE_TICKETS.slice(0, 10).map(ticket => `
                                <tr onclick="viewTicket('${ticket.ticket_id}')">
                                    <td>#${ticket.ticket_number}</td>
                                    <td>${ticket.type === 'incident' ? 'ğŸš¨' : ticket.type === 'service_request' ? 'ğŸ“‹' : 'ğŸ”„'}</td>
                                    <td style="max-width: 250px; overflow: hidden; text-overflow: ellipsis;">${ticket.subject}</td>
                                    <td><span class="tag tag-${ticket.priority.toLowerCase()}">${ticket.priority}</span></td>
                                    <td><span class="tag tag-${ticket.status.toLowerCase().replace(/ /g, '-')}">${ticket.status}</span></td>
                                    <td><span class="tag">${ITSM_TYPES[ticket.itsm_type].icon}</span></td>
                                    <td>${ticket.ai_processed ? 'ğŸ¤–' : '-'}</td>
                                    <td style="font-size: 12px;">${new Date(ticket.created_at).toLocaleString('ja-JP', { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' })}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ“Š ITSMåˆ†é¡çµ±è¨ˆ</h3>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        ${Object.entries(ITSM_TYPES).map(([key, type]) => {
                            const count = SAMPLE_TICKETS.filter(t => t.itsm_type === key).length;
                            const percentage = Math.round((count / total) * 100);
                            return `
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <span style="font-size: 24px;">${type.icon}</span>
                                    <div style="flex: 1;">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                            <span style="font-weight: 600;">${type.label}</span>
                                            <span style="color: var(--gray-500);">${count}ä»¶ (${percentage}%)</span>
                                        </div>
                                        <div style="background: var(--gray-200); height: 8px; border-radius: 4px; overflow: hidden;">
                                            <div style="background: var(--primary); height: 100%; width: ${percentage}%; transition: width 0.3s;"></div>
                                        </div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ¯ å“è³ªä¿è¨¼Hooks</h3>
                    </div>
                    <div class="timeline">
                        ${HOOKS_LOGS.map(hook => `
                            <div class="timeline-item completed">
                                <div class="timeline-content">
                                    <div class="timeline-title">âœ… ${hook.hook}</div>
                                    <div class="timeline-desc">${hook.result}</div>
                                    <div class="timeline-time">${hook.duration}ç§’</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        `;
    },

    // ãã®ä»–ã®ãƒšãƒ¼ã‚¸ã¯çœç•¥å½¢ã§å®šç¾©
    'ai-assistant': () => pages_aiAssistant(),
    tickets: async () => pages_tickets(),
    'ai-knowledge': async () => pages_aiKnowledge(),
    knowledge: async () => pages_knowledge(),
    approvals: async () => pages_approvals(),
    m365: () => pages_m365(),
};
