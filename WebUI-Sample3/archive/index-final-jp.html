<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mirai HelpDesk - ãƒãƒ«ãƒAIçµ±åˆç‰ˆ</title>
    <link rel="stylesheet" href="css/professional.css">
    <link rel="stylesheet" href="css/chat-styles.css">
</head>
<body>
    <div class="app-container">
        <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                            <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                            <path d="M2 17l10 5 10-5"/>
                            <path d="M2 12l10 5 10-5"/>
                        </svg>
                    </div>
                    <div class="logo-text">
                        <span class="logo-title">Mirai HelpDesk</span>
                        <span class="logo-subtitle">ãƒãƒ«ãƒAIçµ±åˆç‰ˆ</span>
                    </div>
                </div>
            </div>

            <nav class="sidebar-nav">
                <!-- ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
                <div class="nav-section">
                    <span class="nav-section-title">ãƒ¡ã‚¤ãƒ³</span>
                    <a class="nav-item active" data-section="ai-support">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                        </svg>
                        <span>AIã‚µãƒãƒ¼ãƒˆ</span>
                        <span class="nav-badge">New</span>
                    </a>
                    <a class="nav-item" data-section="my-tickets">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14 2 14 8 20 8"/>
                        </svg>
                        <span>ãƒã‚¤ãƒã‚±ãƒƒãƒˆ</span>
                        <span class="nav-count">5</span>
                    </a>
                    <a class="nav-item" data-section="create-ticket">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <line x1="12" y1="8" x2="12" y2="16"/>
                            <line x1="8" y1="12" x2="16" y2="12"/>
                        </svg>
                        <span>æ–°è¦ãƒã‚±ãƒƒãƒˆä½œæˆ</span>
                    </a>
                    <a class="nav-item" data-section="helpdesk-list">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="8" y1="6" x2="21" y2="6"/>
                            <line x1="8" y1="12" x2="21" y2="12"/>
                            <line x1="8" y1="18" x2="21" y2="18"/>
                            <line x1="3" y1="6" x2="3.01" y2="6"/>
                            <line x1="3" y1="12" x2="3.01" y2="12"/>
                            <line x1="3" y1="18" x2="3.01" y2="18"/>
                        </svg>
                        <span>ãƒ˜ãƒ«ãƒ—ãƒ‡ã‚¹ã‚¯ä¸€è¦§</span>
                        <span class="nav-count">50</span>
                    </a>
                    <a class="nav-item" data-section="faq">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                            <line x1="12" y1="17" x2="12.01" y2="17"/>
                        </svg>
                        <span>FAQ</span>
                    </a>
                </div>

                <!-- ã‚«ãƒ†ã‚´ãƒª -->
                <div class="nav-section">
                    <span class="nav-section-title">ã‚«ãƒ†ã‚´ãƒª</span>
                    <a class="nav-item category" data-category="network">
                        <span class="category-dot network"></span>
                        <span>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</span>
                    </a>
                    <a class="nav-item category" data-category="software">
                        <span class="category-dot software"></span>
                        <span>ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢</span>
                    </a>
                    <a class="nav-item category" data-category="hardware">
                        <span class="category-dot hardware"></span>
                        <span>ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢</span>
                    </a>
                    <a class="nav-item category" data-category="security">
                        <span class="category-dot security"></span>
                        <span>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</span>
                    </a>
                    <a class="nav-item category" data-category="account">
                        <span class="category-dot account"></span>
                        <span>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</span>
                    </a>
                </div>

                <!-- ã‚·ã‚¹ãƒ†ãƒ ç®¡ç† -->
                <div class="nav-section">
                    <span class="nav-section-title">ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†</span>
                    <a class="nav-item" data-section="approvals">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="20 6 9 17 4 12"/>
                        </svg>
                        <span>æ‰¿èªç®¡ç†</span>
                        <span class="nav-count">3</span>
                    </a>
                    <a class="nav-item" data-section="m365">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                            <line x1="9" y1="9" x2="15" y2="15"/>
                            <line x1="15" y1="9" x2="9" y2="15"/>
                        </svg>
                        <span>M365ç®¡ç†</span>
                    </a>
                    <a class="nav-item" data-section="settings">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="3"/>
                            <path d="M12 1v6m0 6v6M3.93 6.93l4.24 4.24m8.49 8.49l4.24 4.24M1 12h6m6 0h6m-12.07 6.07l4.24-4.24m8.49-8.49l4.24-4.24"/>
                        </svg>
                        <span>ã‚·ã‚¹ãƒ†ãƒ è¨­å®š</span>
                    </a>
                </div>
            </nav>

            <div class="sidebar-footer">
                <div class="system-status">
                    <div class="status-indicator online"></div>
                    <span>å…¨ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒä¸­</span>
                </div>
                <div class="user-card">
                    <div class="user-avatar">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                        </svg>
                    </div>
                    <div class="user-info">
                        <span class="user-name">ä½è—¤èŠ±å­</span>
                        <span class="user-dept">Agent</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <main class="main-content">
            <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
            <header class="main-header">
                <div class="header-left">
                    <h1 id="page-heading">AIã‚µãƒãƒ¼ãƒˆãƒãƒ£ãƒƒãƒˆ</h1>
                    <div class="breadcrumb">
                        <span>IT HelpDesk</span>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                        <span class="current" id="breadcrumb-current">AIã‚µãƒãƒ¼ãƒˆ</span>
                    </div>
                </div>
                <div class="header-right">
                    <button class="header-btn" onclick="navigate('create-ticket')">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
                        </svg>
                        <span>æ–°è¦ãƒã‚±ãƒƒãƒˆ</span>
                    </button>
                    <button class="header-icon-btn" title="é€šçŸ¥">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
                        </svg>
                        <span class="notification-badge">2</span>
                    </button>
                </div>
            </header>

            <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³: AIã‚µãƒãƒ¼ãƒˆ -->
            <div class="section-content" id="section-ai-support">
                <div class="chat-area">
                    <div class="chat-messages" id="chatMessages">
                        <!-- ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚«ãƒ¼ãƒ‰ -->
                        <div class="welcome-card">
                            <div class="welcome-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <path d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                                </svg>
                            </div>
                            <h2>ITã‚µãƒãƒ¼ãƒˆã¸ã‚ˆã†ã“ã</h2>
                            <p>AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆãŒæŠ€è¡“çš„ãªå•é¡Œè§£æ±ºã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚<br>è³ªå•ã‚’å…¥åŠ›ã™ã‚‹ã‹ã€ä¸‹ã®ãƒˆãƒ”ãƒƒã‚¯ã‹ã‚‰é¸æŠã—ã¦ãã ã•ã„ã€‚</p>

                            <div class="quick-topics">
                                <button class="topic-btn" onclick="selectTopic('wifi')">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M5 12.55a11 11 0 0 1 14.08 0"/>
                                        <path d="M1.42 9a16 16 0 0 1 21.16 0"/>
                                        <path d="M8.53 16.11a6 6 0 0 1 6.95 0"/>
                                        <line x1="12" y1="20" x2="12.01" y2="20"/>
                                    </svg>
                                    <span>WiFiæ¥ç¶š</span>
                                </button>
                                <button class="topic-btn" onclick="selectTopic('vpn')">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                        <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                                    </svg>
                                    <span>VPNè¨­å®š</span>
                                </button>
                                <button class="topic-btn" onclick="selectTopic('password')">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
                                    </svg>
                                    <span>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</span>
                                </button>
                                <button class="topic-btn" onclick="selectTopic('printer')">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 6 2 18 2 18 9"/>
                                        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/>
                                        <rect x="6" y="14" width="12" height="8"/>
                                    </svg>
                                    <span>ãƒ—ãƒªãƒ³ã‚¿ãƒ¼</span>
                                </button>
                                <button class="topic-btn" onclick="selectTopic('software')">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                                        <line x1="8" y1="21" x2="16" y2="21"/>
                                        <line x1="12" y1="17" x2="12" y2="21"/>
                                    </svg>
                                    <span>ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢</span>
                                </button>
                                <button class="topic-btn" onclick="selectTopic('email')">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                                        <polyline points="22,6 12,13 2,6"/>
                                    </svg>
                                    <span>ãƒ¡ãƒ¼ãƒ«è¨­å®š</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- AIå‡¦ç†ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ -->
                    <div class="ai-processing" id="aiProcessing" style="display: none;">
                        <div class="processing-content">
                            <div class="processing-stages">
                                <div class="stage" id="stageAnalyze">
                                    <div class="stage-icon">ğŸ”</div>
                                    <div class="stage-label">å•é¡Œåˆ†æ</div>
                                    <div class="stage-progress"></div>
                                </div>
                                <div class="stage" id="stageSearch">
                                    <div class="stage-icon">ğŸ“š</div>
                                    <div class="stage-label">KBæ¤œç´¢</div>
                                    <div class="stage-progress"></div>
                                </div>
                                <div class="stage" id="stageGenerate">
                                    <div class="stage-icon">ğŸ¤–</div>
                                    <div class="stage-label">å›ç­”ç”Ÿæˆ</div>
                                    <div class="stage-progress"></div>
                                </div>
                            </div>
                            <div class="processing-text" id="processingText">å•é¡Œã‚’åˆ†æã—ã¦ã„ã¾ã™...</div>
                        </div>
                    </div>

                    <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ -->
                    <div class="input-area">
                        <div class="input-toolbar">
                            <button class="toolbar-btn" title="ãƒ•ã‚¡ã‚¤ãƒ«æ·»ä»˜">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/>
                                </svg>
                            </button>
                            <button class="toolbar-btn" title="ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                    <circle cx="8.5" cy="8.5" r="1.5"/>
                                    <polyline points="21 15 16 10 5 21"/>
                                </svg>
                            </button>
                        </div>
                        <div class="input-container">
                            <textarea
                                id="messageInput"
                                placeholder="ITé–¢é€£ã®è³ªå•ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."
                                rows="1"
                                onkeydown="if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();sendMessage();}"
                            ></textarea>
                            <button class="send-btn" id="sendBtn" onclick="sendMessage()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="22" y1="2" x2="11" y2="13"/>
                                    <polygon points="22 2 15 22 11 13 2 9 22 2"/>
                                </svg>
                            </button>
                        </div>
                        <div class="input-footer">
                            <span class="ai-badge">
                                <span class="ai-dot"></span>
                                AI Powered by Claude + Gemini + Perplexity
                            </span>
                            <span class="shortcut-hint">Enter ã§é€ä¿¡ â€¢ Shift+Enter ã§æ”¹è¡Œ</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³: ãƒã‚¤ãƒã‚±ãƒƒãƒˆ -->
            <div class="section-content" id="section-my-tickets" style="display: none;">
                <div class="content-area">
                    <div class="content-header">
                        <h2>ãƒã‚¤ãƒã‚±ãƒƒãƒˆ</h2>
                        <p>ã‚ãªãŸã®ã‚µãƒãƒ¼ãƒˆãƒã‚±ãƒƒãƒˆä¸€è¦§</p>
                    </div>
                    <div class="tickets-container">
                        <div class="tickets-filter">
                            <button class="filter-btn active" data-filter="all" onclick="filterTickets('all')">ã™ã¹ã¦</button>
                            <button class="filter-btn" data-filter="new" onclick="filterTickets('new')">æ–°è¦</button>
                            <button class="filter-btn" data-filter="open" onclick="filterTickets('open')">æœªå¯¾å¿œ</button>
                            <button class="filter-btn" data-filter="in-progress" onclick="filterTickets('in-progress')">å¯¾å¿œä¸­</button>
                            <button class="filter-btn" data-filter="pending" onclick="filterTickets('pending')">ä¿ç•™ä¸­</button>
                            <button class="filter-btn" data-filter="resolved" onclick="filterTickets('resolved')">è§£æ±ºæ¸ˆã¿</button>
                            <button class="filter-btn" data-filter="closed" onclick="filterTickets('closed')">å®Œäº†</button>
                        </div>
                        <div class="tickets-list" id="ticketsList">
                            <!-- ãƒã‚±ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³: ãƒ˜ãƒ«ãƒ—ãƒ‡ã‚¹ã‚¯ä¸€è¦§ -->
            <div class="section-content" id="section-helpdesk-list" style="display: none;"></div>

            <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³: æ–°è¦ãƒã‚±ãƒƒãƒˆä½œæˆ -->
            <div class="section-content" id="section-create-ticket" style="display: none;"></div>

            <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³: FAQ -->
            <div class="section-content" id="section-faq" style="display: none;"></div>

            <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³: æ‰¿èªç®¡ç† -->
            <div class="section-content" id="section-approvals" style="display: none;"></div>

            <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³: M365ç®¡ç† -->
            <div class="section-content" id="section-m365" style="display: none;"></div>

            <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³: ã‚·ã‚¹ãƒ†ãƒ è¨­å®š -->
            <div class="section-content" id="section-settings" style="display: none;"></div>
        </main>
    </div>

    <script src="js/sample-data.js"></script>
    <script src="js/ai-orchestration.js"></script>
    <script>
        console.log('%cğŸš€ Mirai HelpDesk - æ—¥æœ¬èªç‰ˆå®Œæˆ', 'color: #3b82f6; font-size: 20px; font-weight: bold;');
        console.log('%cWebUI-Sample2ã®AIã‚µãƒãƒ¼ãƒˆ + ãƒãƒ«ãƒAIæ©Ÿèƒ½çµ±åˆ', 'color: #10b981; font-size: 14px;');

        let currentFilter = 'all';

        // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
        document.querySelectorAll('[data-section]').forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                const section = item.dataset.section;

                document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                item.classList.add('active');

                console.log('ğŸ“„ Navigate to:', section);
                loadSection(section);
            });
        });

        function navigate(section) {
            const navItem = document.querySelector(`[data-section="${section}"]`);
            if (navItem) navItem.click();
        }

        function loadSection(section) {
            // ã™ã¹ã¦ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’éè¡¨ç¤º
            document.querySelectorAll('.section-content').forEach(s => s.style.display = 'none');

            // ãƒ˜ãƒƒãƒ€ãƒ¼æ›´æ–°
            const titles = {
                'ai-support': 'AIã‚µãƒãƒ¼ãƒˆãƒãƒ£ãƒƒãƒˆ',
                'my-tickets': 'ãƒã‚¤ãƒã‚±ãƒƒãƒˆ',
                'create-ticket': 'æ–°è¦ãƒã‚±ãƒƒãƒˆä½œæˆ',
                'helpdesk-list': 'ãƒ˜ãƒ«ãƒ—ãƒ‡ã‚¹ã‚¯ä¸€è¦§',
                'faq': 'ã‚ˆãã‚ã‚‹è³ªå•',
                'approvals': 'æ‰¿èªç®¡ç†',
                'm365': 'M365ç®¡ç†',
                'settings': 'ã‚·ã‚¹ãƒ†ãƒ è¨­å®š',
            };
            const breadcrumbs = {
                'ai-support': 'AIã‚µãƒãƒ¼ãƒˆ',
                'my-tickets': 'ãƒã‚¤ãƒã‚±ãƒƒãƒˆ',
                'create-ticket': 'æ–°è¦ä½œæˆ',
                'helpdesk-list': 'ãƒ˜ãƒ«ãƒ—ãƒ‡ã‚¹ã‚¯ä¸€è¦§',
                'faq': 'FAQ',
                'approvals': 'æ‰¿èªç®¡ç†',
                'm365': 'M365',
                'settings': 'è¨­å®š',
            };

            document.getElementById('page-heading').textContent = titles[section] || section;
            document.getElementById('breadcrumb-current').textContent = breadcrumbs[section] || section;

            // ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¡¨ç¤º
            const sectionElement = document.getElementById(`section-${section}`);
            if (sectionElement) {
                sectionElement.style.display = 'block';

                // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å‹•çš„ã«ç”Ÿæˆ
                if (section === 'my-tickets') {
                    renderMyTickets();
                } else if (section === 'helpdesk-list') {
                    renderHelpdeskList();
                } else if (section === 'create-ticket') {
                    renderCreateTicket();
                } else if (section === 'faq') {
                    renderFAQ();
                } else if (section === 'approvals') {
                    renderApprovals();
                } else if (section === 'm365') {
                    renderM365();
                } else if (section === 'settings') {
                    renderSettings();
                }
            }
        }

        // ãƒã‚¤ãƒã‚±ãƒƒãƒˆè¡¨ç¤º
        function renderMyTickets() {
            loadTicketCards('all');
        }

        function loadTicketCards(filter) {
            currentFilter = filter;
            const ticketsList = document.getElementById('ticketsList');
            const myTickets = SAMPLE_TICKETS.filter(t => t.requester_id === 'u1');

            let filteredTickets = myTickets;
            if (filter === 'new') filteredTickets = myTickets.filter(t => t.status === 'New');
            else if (filter === 'open') filteredTickets = myTickets.filter(t => t.status === 'New' || t.status === 'Triage');
            else if (filter === 'in-progress') filteredTickets = myTickets.filter(t => t.status === 'In Progress' || t.status === 'Assigned');
            else if (filter === 'pending') filteredTickets = myTickets.filter(t => t.status.includes('Pending'));
            else if (filter === 'resolved') filteredTickets = myTickets.filter(t => t.status === 'Resolved');
            else if (filter === 'closed') filteredTickets = myTickets.filter(t => t.status === 'Closed');

            ticketsList.innerHTML = filteredTickets.map(t => {
                const statusClass = t.status === 'New' || t.status === 'Triage' ? 'open' :
                                  t.status.includes('Progress') || t.status === 'Assigned' ? 'in-progress' :
                                  t.status === 'Resolved' ? 'resolved' : 'closed';
                const statusLabel = t.status === 'New' ? 'æ–°è¦' :
                                  t.status === 'Triage' ? 'æœªå¯¾å¿œ' :
                                  t.status.includes('Progress') ? 'å¯¾å¿œä¸­' :
                                  t.status === 'Assigned' ? 'æ‹…å½“å‰²å½“æ¸ˆã¿' :
                                  t.status.includes('Pending') ? 'ä¿ç•™ä¸­' :
                                  t.status === 'Resolved' ? 'è§£æ±ºæ¸ˆã¿' : 'å®Œäº†';

                return `
                    <div class="ticket-card" data-status="${statusClass}">
                        <div class="ticket-header">
                            <span class="ticket-id">#TKT-${t.ticket_number.toString().padStart(4, '0')}</span>
                            <span class="ticket-status-badge ${statusClass}">${statusLabel}</span>
                        </div>
                        <h3 class="ticket-title">${t.subject}</h3>
                        <p class="ticket-desc">${t.description}</p>
                        <div class="ticket-meta">
                            <span class="ticket-category">
                                <span class="category-dot ${['network','software','hardware','security','account'][t.ticket_number % 5]}"></span>
                                ${['ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯','ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢','ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢','ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£','ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ'][t.ticket_number % 5]}
                            </span>
                            <span class="ticket-date">${t.resolved_at ? 'âœ… ' + new Date(t.resolved_at).toLocaleDateString('ja-JP') + ' è§£æ±º' : 'ğŸ“… ' + new Date(t.created_at).toLocaleDateString('ja-JP') + ' ä½œæˆ'}</span>
                        </div>
                        ${statusClass === 'in-progress' ? `
                            <div class="ticket-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${Math.random() * 40 + 40}%;"></div>
                                </div>
                                <span class="progress-text">æ‹…å½“: ${t.assignee_id ? SAMPLE_USERS.find(u => u.user_id === t.assignee_id)?.display_name : 'æœªå‰²å½“'} - èª¿æŸ»ä¸­</span>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function filterTickets(filter) {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.filter === filter) {
                    btn.classList.add('active');
                }
            });
            loadTicketCards(filter);
        }

        // ãƒˆãƒ”ãƒƒã‚¯é¸æŠ
        function selectTopic(topic) {
            const topicMessages = {
                wifi: 'WiFiã«æ¥ç¶šã§ãã¾ã›ã‚“',
                vpn: 'VPNã®è¨­å®šæ–¹æ³•ã‚’æ•™ãˆã¦ãã ã•ã„',
                password: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒªã‚»ãƒƒãƒˆã—ãŸã„ã§ã™',
                printer: 'ãƒ—ãƒªãƒ³ã‚¿ãƒ¼ã«æ¥ç¶šã§ãã¾ã›ã‚“',
                software: 'ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•',
                email: 'ãƒ¡ãƒ¼ãƒ«è¨­å®šã«ã¤ã„ã¦æ•™ãˆã¦ãã ã•ã„'
            };

            document.getElementById('messageInput').value = topicMessages[topic] || '';
            sendMessage();
        }

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            if (!message) return;

            console.log('ğŸ’¬ Message:', message);

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            addMessage(message, 'user');
            input.value = '';

            // AIå‡¦ç†è¡¨ç¤º
            document.getElementById('aiProcessing').style.display = 'block';
            document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;

            // AIå‡¦ç†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            await processWithAI(message);
        }

        function addMessage(text, type) {
            const messagesDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}-message`;

            if (type === 'user') {
                messageDiv.innerHTML = `
                    <div class="message-content">${escapeHtml(text)}</div>
                    <div class="message-time">${new Date().toLocaleTimeString('ja-JP', {hour: '2-digit', minute: '2-digit'})}</div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="message-avatar">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                        </svg>
                    </div>
                    <div class="message-bubble">
                        <div class="message-content">${text}</div>
                        <div class="message-time">${new Date().toLocaleTimeString('ja-JP', {hour: '2-digit', minute: '2-digit'})}</div>
                    </div>
                `;
            }

            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        async function processWithAI(message) {
            const stages = ['analyze', 'search', 'generate'];
            const stageTexts = [
                'å•é¡Œã‚’åˆ†æã—ã¦ã„ã¾ã™...',
                'ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã‚’æ¤œç´¢ã—ã¦ã„ã¾ã™...',
                'AIå›ç­”ã‚’ç”Ÿæˆã—ã¦ã„ã¾ã™...'
            ];

            for (let i = 0; i < stages.length; i++) {
                document.getElementById('processingText').textContent = stageTexts[i];
                document.getElementById('stage' + stages[i].charAt(0).toUpperCase() + stages[i].slice(1)).classList.add('active');

                await new Promise(r => setTimeout(r, 800));

                document.getElementById('stage' + stages[i].charAt(0).toUpperCase() + stages[i].slice(1)).classList.add('completed');
            }

            // AIå¿œç­”ã‚’ç”Ÿæˆ
            const response = generateAIResponse(message);

            document.getElementById('aiProcessing').style.display = 'none';

            // ã‚¹ãƒ†ãƒ¼ã‚¸ã‚’ãƒªã‚»ãƒƒãƒˆ
            document.querySelectorAll('.stage').forEach(s => {
                s.classList.remove('active', 'completed');
            });

            addMessage(response, 'assistant');
        }

        function generateAIResponse(message) {
            const lowerMessage = message.toLowerCase();

            if (lowerMessage.includes('wifi') || lowerMessage.includes('ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯') || lowerMessage.includes('æ¥ç¶š')) {
                return `WiFiæ¥ç¶šã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’ã”æ¡ˆå†…ã—ã¾ã™ï¼š\n\n1. WiFiãŒã‚ªãƒ³ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„\n2. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸€è¦§ã‹ã‚‰ç¤¾å†…WiFiã€ŒCORP-WIFIã€ã‚’é¸æŠ\n3. æ¥ç¶šã§ããªã„å ´åˆã¯ã€ä¸€åº¦WiFiã‚’ã‚ªãƒ•â†’ã‚ªãƒ³ã«ã—ã¦ãã ã•ã„\n4. å•é¡ŒãŒç¶šãå ´åˆã¯ã€PCã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„\n\nãã‚Œã§ã‚‚è§£æ±ºã—ãªã„å ´åˆã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éšœå®³ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ITéƒ¨é–€ï¼ˆå†…ç·š: 3456ï¼‰ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚`;
            } else if (lowerMessage.includes('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰') || lowerMessage.includes('password')) {
                return `ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆã®æ‰‹é †ã‚’ã”æ¡ˆå†…ã—ã¾ã™ï¼š\n\n1. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆãƒãƒ¼ã‚¿ãƒ«: https://passwordreset.company.co.jp ã«ã‚¢ã‚¯ã‚»ã‚¹\n2. ç™»éŒ²æ¸ˆã¿ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯é›»è©±ç•ªå·ã§æœ¬äººç¢ºèª\n3. æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šï¼ˆ8æ–‡å­—ä»¥ä¸Šã€å¤§å°è‹±å­—+æ•°å­—+è¨˜å·ï¼‰\n4. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´å¾Œã€å…¨ãƒ‡ãƒã‚¤ã‚¹ã§å†ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦\n\nâ€» ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯æ™‚ã¯30åˆ†å¾Œã«è‡ªå‹•è§£é™¤ã•ã‚Œã¾ã™ã€‚æ€¥ãã®å ´åˆã¯ITéƒ¨é–€ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚`;
            } else if (lowerMessage.includes('ãƒ—ãƒªãƒ³ã‚¿ãƒ¼') || lowerMessage.includes('printer') || lowerMessage.includes('å°åˆ·')) {
                return `ãƒ—ãƒªãƒ³ã‚¿ãƒ¼ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’ã”æ¡ˆå†…ã—ã¾ã™ï¼š\n\n1. ãƒ—ãƒªãƒ³ã‚¿ãƒ¼ã®é›»æºã¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèª\n2. å°åˆ·ã‚­ãƒ¥ãƒ¼ã«æºœã¾ã£ã¦ã„ã‚‹ã‚¸ãƒ§ãƒ–ã‚’å‰Šé™¤\n3. ãƒ—ãƒªãƒ³ã‚¿ãƒ¼ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«\n4. ã€Œè¨­å®šã€â†’ã€Œãƒ—ãƒªãƒ³ã‚¿ãƒ¼ã¨ã‚¹ã‚­ãƒ£ãƒŠãƒ¼ã€ã‹ã‚‰å†è¨­å®š\n\nãƒ—ãƒªãƒ³ã‚¿ãƒ¼æ•…éšœã®å ´åˆã¯ã€ç·å‹™éƒ¨ï¼ˆå†…ç·š: 4567ï¼‰ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚`;
            } else if (lowerMessage.includes('vpn')) {
                return `VPNæ¥ç¶šã®æ‰‹é †ã‚’ã”æ¡ˆå†…ã—ã¾ã™ï¼š\n\n1. FortiClient VPNã‚¢ãƒ—ãƒªã‚’èµ·å‹•\n2. æ¥ç¶šå…ˆ: vpn.company.co.jp ã‚’é¸æŠ\n3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ID: ç¤¾å“¡ç•ªå·ã‚’å…¥åŠ›\n4. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: ADãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›\n5. äºŒè¦ç´ èªè¨¼: Microsoft Authenticatorã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›\n\nâ€» VPNã‚µãƒ¼ãƒãƒ¼ã®å•é¡Œã®å ´åˆã¯ã€ITéƒ¨é–€ï¼ˆå†…ç·š: 3456ï¼‰ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚`;
            } else if (lowerMessage.includes('ãƒ¡ãƒ¼ãƒ«') || lowerMessage.includes('outlook')) {
                return `ãƒ¡ãƒ¼ãƒ«è¨­å®šã®ã‚µãƒãƒ¼ãƒˆã‚’ã”æ¡ˆå†…ã—ã¾ã™ï¼š\n\n1. Outlook / Microsoft 365ã«ã‚µã‚¤ãƒ³ã‚¤ãƒ³\n2. ç¤¾å“¡ãƒ¡ãƒ¼ãƒ«: firstname.lastname@company.co.jp\n3. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: ADãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¨åŒã˜\n4. 2æ®µéšèªè¨¼ãŒå¿…è¦ãªå ´åˆã¯Authenticatorã‚¢ãƒ—ãƒªã‚’ä½¿ç”¨\n\næ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºä¸Šé™: 25MB\nå¤§ããªãƒ•ã‚¡ã‚¤ãƒ«ã¯OneDriveãƒªãƒ³ã‚¯ã§å…±æœ‰ã—ã¦ãã ã•ã„ã€‚`;
            } else {
                return `ã”è³ªå•ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚\n\n${message}ã«ã¤ã„ã¦ã€AIãŒå›ç­”ã‚’ç”Ÿæˆã—ã¾ã—ãŸã€‚\n\nã‚ˆã‚Šè©³ã—ã„ã‚µãƒãƒ¼ãƒˆãŒå¿…è¦ãªå ´åˆã¯ã€æ–°è¦ãƒã‚±ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹ã‹ã€ITéƒ¨é–€ï¼ˆå†…ç·š: 3456ï¼‰ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚`;
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML.replace(/\n/g, '<br>');
        }

        // ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆã¯æ¬¡ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§...
    </script>

    <script src="js/pages-jp.js"></script>
</body>
</html>
