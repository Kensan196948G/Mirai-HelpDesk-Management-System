# ğŸª Hooksæ©Ÿèƒ½ - ä¸¦åˆ—é–‹ç™ºè‡ªå‹•åŒ–

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€Gitæ“ä½œã¨Claude Codeæ“ä½œã«é€£å‹•ã™ã‚‹4ã¤ã®HooksãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
.claude/hooks/
â”œâ”€â”€ README.md                      # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ parallel-development.json      # ä¸¦åˆ—é–‹ç™ºè¨­å®šï¼ˆæ—¢å­˜ï¼‰
â”œâ”€â”€ pre-commit.json               # ã‚³ãƒŸãƒƒãƒˆå‰ã®å“è³ªãƒã‚§ãƒƒã‚¯
â”œâ”€â”€ post-commit.json              # ã‚³ãƒŸãƒƒãƒˆå¾Œã®è‡ªå‹•ãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ pre-push.json                 # ãƒ—ãƒƒã‚·ãƒ¥å‰ã®ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆæ¤œå‡º
â”œâ”€â”€ user-prompt-submit.json       # ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›æ™‚ã®ä¸¦åˆ—ã‚¿ã‚¹ã‚¯èµ·å‹•
â””â”€â”€ logs/                         # Hookå®Ÿè¡Œãƒ­ã‚°
```

## ğŸ”§ 4ã¤ã®Hooks

### 1. pre-commit Hook
**ãƒˆãƒªã‚¬ãƒ¼**: `git commit` å®Ÿè¡Œå‰

**æ©Ÿèƒ½**:
- âœ… ESLintã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯
- âœ… Prettierã«ã‚ˆã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒã‚§ãƒƒã‚¯ï¼ˆè‡ªå‹•ä¿®æ­£ï¼‰
- âœ… ãƒ‡ãƒãƒƒã‚°ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆæ¤œå‡º
- âœ… TODOã‚³ãƒ¡ãƒ³ãƒˆè­¦å‘Š
- âœ… ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãƒã‚§ãƒƒã‚¯
- âœ… ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆãƒãƒ¼ã‚«ãƒ¼æ¤œå‡º
- âœ… ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæƒ…å ±æ¤œå‡º

**ãƒã‚¤ãƒ‘ã‚¹**:
```bash
# ç’°å¢ƒå¤‰æ•°ã§ã‚¹ã‚­ãƒƒãƒ—
export SKIP_PRE_COMMIT=true
git commit -m "message"

# ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã‚¹ã‚­ãƒƒãƒ—
git commit -m "[skip-hooks] emergency fix"
```

### 2. post-commit Hook
**ãƒˆãƒªã‚¬ãƒ¼**: `git commit` å®Ÿè¡Œå¾Œ

**æ©Ÿèƒ½**:
- âœ… å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã«é–¢é€£ã™ã‚‹ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- âœ… APIå¤‰æ›´æ™‚ã®çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- âœ… ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å¤‰æ›´æ™‚ã®E2Eãƒ†ã‚¹ãƒˆï¼ˆã‚µãƒ³ãƒ—ãƒ«ï¼‰
- âœ… ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒã‚§ãƒƒã‚¯
- âœ… ä»–ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¸ã®å¤‰æ›´é€šçŸ¥
- âœ… ãƒ“ãƒ«ãƒ‰ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°

**ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œ**:
ãƒ†ã‚¹ãƒˆã¯ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å®Ÿè¡Œã•ã‚Œã€å®Œäº†æ™‚ã«é€šçŸ¥ã•ã‚Œã¾ã™ã€‚

**ãƒã‚¤ãƒ‘ã‚¹**:
```bash
# ãƒ†ã‚¹ãƒˆã‚’ã‚¹ã‚­ãƒƒãƒ—
export SKIP_POST_COMMIT=true
git commit -m "message"

# ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã‚¹ã‚­ãƒƒãƒ—
git commit -m "[skip-tests] work in progress"
```

### 3. pre-push Hook
**ãƒˆãƒªã‚¬ãƒ¼**: `git push` å®Ÿè¡Œå‰

**æ©Ÿèƒ½**:
- âœ… ãƒªãƒ¢ãƒ¼ãƒˆã¨ã®å·®åˆ†ãƒã‚§ãƒƒã‚¯
- âœ… æ½œåœ¨çš„ãªã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆæ¤œå‡ºï¼ˆã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯è§£æï¼‰
- âœ… ä»–ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ­ãƒƒã‚¯ãƒã‚§ãƒƒã‚¯
- âœ… å…¨ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå®Ÿè¡Œ
- âœ… ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèªï¼ˆmain/masterãƒ–ãƒ©ãƒ³ãƒï¼‰
- âœ… ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å½¢å¼ãƒã‚§ãƒƒã‚¯
- âœ… ãƒ–ãƒ©ãƒ³ãƒä¿è­·ãƒ«ãƒ¼ãƒ«ç¢ºèª
- âœ… æœ€çµ‚ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆãƒã‚§ãƒƒã‚¯

**é‡è¦**: ã“ã®Hookã¯ãƒ—ãƒƒã‚·ãƒ¥ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

**ãƒã‚¤ãƒ‘ã‚¹**:
```bash
# ç’°å¢ƒå¤‰æ•°ã§ã‚¹ã‚­ãƒƒãƒ—
export SKIP_PRE_PUSH=true
git push

# Gitãƒ•ãƒ©ã‚°ã§ã‚¹ã‚­ãƒƒãƒ—
git push --no-verify
```

### 4. user-prompt-submit Hook
**ãƒˆãƒªã‚¬ãƒ¼**: Claude Codeã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é€ä¿¡ã—ãŸæ™‚

**æ©Ÿèƒ½**:
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®è‡ªç„¶è¨€èªè§£æ
- âœ… ã‚¿ã‚¹ã‚¯è¤‡é›‘åº¦ã®è‡ªå‹•æ¤œå‡º
- âœ… é©åˆ‡ãªSubAgentã¸ã®è‡ªå‹•å‰²ã‚Šå½“ã¦
- âœ… ä¸¦åˆ—å®Ÿè¡Œã®å¯å¦åˆ¤å®š
- âœ… ã‚¿ã‚¹ã‚¯åˆ†å‰²è¨ˆç”»ã®è‡ªå‹•ä½œæˆ
- âœ… ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ã®å®Ÿè¡Œèª¿æ•´
- âœ… é€²æ—ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
- âœ… ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆè‡ªå‹•è§£æ±º
- âœ… çµ±åˆæ¤œè¨¼
- âœ… å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

**ã‚¿ã‚¹ã‚¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**:

```javascript
// ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯æ©Ÿèƒ½å®Ÿè£…
ã€Œãƒã‚±ãƒƒãƒˆç®¡ç†æ©Ÿèƒ½ã‚’å®Ÿè£…ã€
â†’ 7ã¤ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒä¸¦åˆ—/é †æ¬¡å®Ÿè¡Œ

// ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã¿
ã€Œãƒã‚±ãƒƒãƒˆAPIã‚’å®Ÿè£…ã€
â†’ agent-6, agent-2, agent-1 ãŒé †æ¬¡å®Ÿè¡Œ

// ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã¿
ã€Œãƒã‚±ãƒƒãƒˆä¸€è¦§ç”»é¢ã‚’å®Ÿè£…ã€
â†’ agent-4, agent-5, agent-3 ãŒä¸¦åˆ—å®Ÿè¡Œ

// UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã¿
ã€Œãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã€
â†’ agent-4 ã®ã¿ãŒå®Ÿè¡Œ

// APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ã¿
ã€Œãƒã‚±ãƒƒãƒˆä½œæˆAPIã‚’è¿½åŠ ã€
â†’ agent-2, agent-1 ãŒé †æ¬¡å®Ÿè¡Œ
```

**ãƒã‚¤ãƒ‘ã‚¹**:
```
# ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«[no-parallel]ã‚’ä»˜ã‘ã‚‹ã¨ä¸¦åˆ—å®Ÿè¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—
[no-parallel] ãƒã‚±ãƒƒãƒˆç®¡ç†æ©Ÿèƒ½ã‚’å®Ÿè£…
```

## ğŸ¯ å®Ÿè¡Œãƒ•ãƒ­ãƒ¼

### é–‹ç™ºè€…ã®é€šå¸¸ãƒ•ãƒ­ãƒ¼

```mermaid
graph TD
    A[ã‚³ãƒ¼ãƒ‰ç·¨é›†] --> B[git add]
    B --> C[git commit]
    C --> D{pre-commit Hook}
    D -->|æˆåŠŸ| E[ã‚³ãƒŸãƒƒãƒˆå®Ÿè¡Œ]
    D -->|å¤±æ•—| A
    E --> F{post-commit Hook}
    F --> G[ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ]
    G --> H[git push]
    H --> I{pre-push Hook}
    I -->|æˆåŠŸ| J[ãƒ—ãƒƒã‚·ãƒ¥å®Ÿè¡Œ]
    I -->|å¤±æ•—| A
```

### ä¸¦åˆ—é–‹ç™ºãƒ•ãƒ­ãƒ¼

```mermaid
graph TD
    A[ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›] --> B{user-prompt-submit Hook}
    B --> C[ã‚¿ã‚¹ã‚¯è§£æ]
    C --> D[è¤‡é›‘åº¦åˆ¤å®š]
    D -->|Simple| E[å˜ä¸€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œ]
    D -->|Complex| F[ä¸¦åˆ—ã‚¿ã‚¹ã‚¯åˆ†å‰²]
    F --> G[agent-6: Database]
    G --> H[agent-2: Models]
    H --> I1[agent-1: API]
    H --> I2[agent-4: Components]
    I1 --> J[agent-5: Services]
    I2 --> J
    J --> K[agent-3: Pages]
    K --> L[agent-7: Docs]
    L --> M[çµ±åˆæ¤œè¨¼]
    M --> N[å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ]
```

## ğŸ“Š ãƒ­ã‚°ã¨ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°

### ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«

```bash
.claude/hooks/logs/
â”œâ”€â”€ pre-commit-2026-01-24.log
â”œâ”€â”€ post-commit-2026-01-24.log
â”œâ”€â”€ pre-push-2026-01-24.log
â””â”€â”€ user-prompt-submit-2026-01-24.log
```

### ãƒ­ã‚°å½¢å¼

```json
{
  "timestamp": "2026-01-24T16:30:00Z",
  "hook": "pre-commit",
  "event": "started",
  "files_changed": 5,
  "checks_passed": 8,
  "checks_failed": 0,
  "duration_ms": 1234,
  "status": "success"
}
```

### ãƒ­ã‚°ç¢ºèªã‚³ãƒãƒ³ãƒ‰

```bash
# Windows PowerShell
Get-Content .claude/hooks/logs/pre-commit-*.log | Select-String "error"

# Linux/Bash
grep "error" .claude/hooks/logs/pre-commit-*.log
```

## ğŸ”§ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### Hookè¨­å®šã®å¤‰æ›´

å„Hookã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`*.json`ï¼‰ã‚’ç·¨é›†ï¼š

```json
{
  "enabled": true,           // Hookã‚’æœ‰åŠ¹åŒ–
  "timeout_seconds": 120,    // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“
  "continue_on_error": false // ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚ç¶šè¡Œã™ã‚‹ã‹
}
```

### ä¸¦åˆ—å®Ÿè¡Œæ•°ã®å¤‰æ›´

`user-prompt-submit.json`ã‚’ç·¨é›†ï¼š

```json
{
  "performance": {
    "max_concurrent_agents": 7  // æœ€å¤§åŒæ™‚å®Ÿè¡Œã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ•°
  }
}
```

### ãƒã‚§ãƒƒã‚¯é …ç›®ã®è¿½åŠ /å‰Šé™¤

å„Hookã®`actions`é…åˆ—ã‚’ç·¨é›†ï¼š

```json
{
  "actions": [
    {
      "name": "custom-check",
      "type": "command",
      "windows": { "command": "..." },
      "linux": { "command": "..." }
    }
  ]
}
```

## ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Hookå®Ÿè¡ŒãŒã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹

```bash
# HookãŒæœ‰åŠ¹ã‹ç¢ºèª
cat .claude/hooks/pre-commit.json | grep "enabled"

# ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª
echo $SKIP_PRE_COMMIT
```

### Hookå®Ÿè¡ŒãŒå¤±æ•—ã™ã‚‹

```bash
# ãƒ­ã‚°ã‚’ç¢ºèª
cat .claude/hooks/logs/pre-commit-*.log | tail -50

# ã‚¨ãƒ©ãƒ¼è©³ç´°ã‚’ç¢ºèª
grep -A 10 "error" .claude/hooks/logs/*.log
```

### ä¸¦åˆ—å®Ÿè¡Œã§ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆ

```bash
# ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ­ãƒƒã‚¯ã‚’ç¢ºèª
ls -la .claude/agents/locks/

# ãƒ­ãƒƒã‚¯ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆæ³¨æ„: å®Ÿè¡Œä¸­ã®ã‚¿ã‚¹ã‚¯ãŒãªã„ã“ã¨ã‚’ç¢ºèªï¼‰
rm -rf .claude/agents/locks/*
```

### ãƒ†ã‚¹ãƒˆãŒé…ã„

```bash
# ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œã‚’æœ‰åŠ¹åŒ–
# post-commit.json ã‚’ç·¨é›†
"background_execution": true
```

## ğŸ¨ Windows/Linuxä¸¡å¯¾å¿œ

å…¨ã¦ã®Hooksã¯Windows PowerShellã¨Linux Bashã®ä¸¡æ–¹ã«å¯¾å¿œã—ã¦ã„ã¾ã™ï¼š

### Windowså®Ÿè¡Œä¾‹

```powershell
# pre-commit
powershell -NoProfile -Command "npm run lint"

# post-commitï¼ˆãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ï¼‰
Start-Job -ScriptBlock { npm run test }

# pre-push
powershell -NoProfile -Command "git fetch origin && npm run test"
```

### Linuxå®Ÿè¡Œä¾‹

```bash
# pre-commit
npm run lint

# post-commitï¼ˆãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ï¼‰
npm run test &

# pre-push
git fetch origin && npm run test
```

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- `.claude/agents/README.md` - SubAgentä¸¦åˆ—é–‹ç™ºã‚·ã‚¹ãƒ†ãƒ 
- `.claude/ADVANCED_FEATURES.md` - SubAgentã¨Hooksã®è©³ç´°
- `CLAUDE.md` - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®è¨­è¨ˆæŒ‡é‡

---

**ä½œæˆæ—¥**: 2026-01-24
**æœ€çµ‚æ›´æ–°**: 2026-01-24
