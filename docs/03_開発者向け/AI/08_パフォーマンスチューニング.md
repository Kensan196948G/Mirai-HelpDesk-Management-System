# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°

AIæ©Ÿèƒ½ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æœ€é©åŒ–ã™ã‚‹ãŸã‚ã®ã€ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥ã€ãƒãƒƒãƒå‡¦ç†ã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã€ã‚³ã‚¹ãƒˆæœ€é©åŒ–æ‰‹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚

---

## ğŸ“‹ ç›®æ¬¡

1. [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™](#ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™)
2. [ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥](#ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥)
3. [ãƒãƒƒãƒå‡¦ç†](#ãƒãƒƒãƒå‡¦ç†)
4. [ãƒ¬ãƒ¼ãƒˆåˆ¶é™](#ãƒ¬ãƒ¼ãƒˆåˆ¶é™)
5. [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–](#ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–)
6. [ã‚³ã‚¹ãƒˆæœ€é©åŒ–](#ã‚³ã‚¹ãƒˆæœ€é©åŒ–)
7. [ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã¨ã‚¢ãƒ©ãƒ¼ãƒˆ](#ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã¨ã‚¢ãƒ©ãƒ¼ãƒˆ)

---

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™

### SLAï¼ˆService Level Agreementï¼‰

| æ©Ÿèƒ½ | p50 | p90 | p99 | æœ€å¤§ |
|------|-----|-----|-----|------|
| ãƒã‚±ãƒƒãƒˆåˆ†é¡ | 2ç§’ | 3ç§’ | 5ç§’ | 8ç§’ |
| ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°åˆ¤å®š | 1.5ç§’ | 2ç§’ | 3ç§’ | 5ç§’ |
| é¡ä¼¼ãƒã‚±ãƒƒãƒˆæ¤œç´¢ | 0.5ç§’ | 1ç§’ | 2ç§’ | 3ç§’ |
| å›ç­”ææ¡ˆ | 3ç§’ | 5ç§’ | 8ç§’ | 10ç§’ |
| ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ | 3ç§’ | 5ç§’ | 10ç§’ | 15ç§’ |

### ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆç›®æ¨™

| æŒ‡æ¨™ | ç›®æ¨™å€¤ |
|------|--------|
| **æœ€å¤§åŒæ™‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°** | 50 req/s |
| **å¹³å‡ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ** | 2.5ç§’ä»¥å†… |
| **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡** | 30%ä»¥ä¸Š |
| **ã‚¨ãƒ©ãƒ¼ç‡** | 1%æœªæº€ |

---

## ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥

### Redis ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ´»ç”¨

**å®Ÿè£…**: `backend/src/services/claude-api.client.ts`

```typescript
export class ClaudeAPIClient {
  private cache: Redis;

  async sendPrompt(
    prompt: string,
    systemPrompt: string = '',
    options: ClaudeAPIOptions = {}
  ): Promise<string> {
    // 1. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚§ãƒƒã‚¯
    if (options.cacheKey) {
      const cached = await this.getCached(options.cacheKey);
      if (cached) {
        console.log(`ğŸ“¦ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆ: ${options.cacheKey}`);
        return cached;  // Claude API ã‚’å‘¼ã°ãšã«å³åº§ã«è¿”å´
      }
    }

    // 2. Claude API å‘¼ã³å‡ºã—
    const response = await this.client.messages.create({ ... });

    // 3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¿å­˜
    if (options.cacheKey) {
      await this.setCache(
        options.cacheKey,
        content,
        options.cacheTTL || 3600  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 1æ™‚é–“
      );
    }

    return content;
  }

  private async getCached(key: string): Promise<string | null> {
    try {
      return await this.cache.get(key);
    } catch (error) {
      console.error('ã‚­ãƒ£ãƒƒã‚·ãƒ¥å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
      return null;  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¨ãƒ©ãƒ¼ã¯ç„¡è¦–ï¼ˆClaude API ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
    }
  }

  private async setCache(key: string, value: string, ttl: number): Promise<void> {
    try {
      await this.cache.setex(key, ttl, value);
    } catch (error) {
      console.error('ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
      // ã‚¨ãƒ©ãƒ¼ã¯è¨˜éŒ²ã™ã‚‹ãŒã€å‡¦ç†ã¯ç¶™ç¶š
    }
  }
}
```

---

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã®è¨­è¨ˆ

**åŸå‰‡**: æ©Ÿèƒ½åˆ¥ + ID ã§ä¸€æ„æ€§ã‚’ç¢ºä¿

```typescript
// ãƒã‚±ãƒƒãƒˆåˆ†é¡
const cacheKey = `ai-classify:${ticket_id}`;

// ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°åˆ¤å®š
const cacheKey = `ai-route:${ticket_id}`;

// é¡ä¼¼ãƒã‚±ãƒƒãƒˆæ¤œç´¢
const cacheKey = `ai-similar:${hashQuery(query)}`;

// å›ç­”ææ¡ˆ
const cacheKey = `ai-suggest:${ticket_id}:${context_hash}`;
```

**ãƒãƒƒã‚·ãƒ¥é–¢æ•°**:
```typescript
function hashQuery(query: string): string {
  const crypto = require('crypto');
  return crypto.createHash('sha256').update(query).digest('hex').substring(0, 16);
}
```

---

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡åŠ¹åŒ–æˆ¦ç•¥

**TTLï¼ˆTime To Liveï¼‰ã®è¨­å®š**:

| ãƒ‡ãƒ¼ã‚¿ç¨®åˆ¥ | TTL | ç†ç”± |
|-----------|-----|------|
| ãƒã‚±ãƒƒãƒˆåˆ†é¡ | 1æ™‚é–“ | ãƒã‚±ãƒƒãƒˆå†…å®¹ã¯å¤‰ã‚ã‚‰ãªã„ |
| ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°åˆ¤å®š | 30åˆ† | æ‹…å½“è€…ã®ç¨¼åƒçŠ¶æ³ãŒå¤‰ã‚ã‚‹å¯èƒ½æ€§ |
| é¡ä¼¼ãƒã‚±ãƒƒãƒˆæ¤œç´¢ | 1æ™‚é–“ | æ–°ã—ã„ãƒã‚±ãƒƒãƒˆãŒè¿½åŠ ã•ã‚Œã‚‹å¯èƒ½æ€§ |
| å›ç­”ææ¡ˆ | 15åˆ† | ã‚³ãƒ¡ãƒ³ãƒˆãŒè¿½åŠ ã•ã‚Œã‚‹å¯èƒ½æ€§ |
| ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ‡ãƒ¼ã‚¿ | 24æ™‚é–“ | æ—¥æ¬¡æ›´æ–°ã§ååˆ† |

**æ‰‹å‹•ç„¡åŠ¹åŒ–**:
```typescript
// ãƒã‚±ãƒƒãƒˆæ›´æ–°æ™‚ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤
async function invalidateCache(ticketId: string) {
  const keys = [
    `ai-classify:${ticketId}`,
    `ai-route:${ticketId}`,
    `ai-suggest:${ticketId}:*`,  // ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰
  ];

  await Promise.all(keys.map(key => redis.del(key)));
}
```

---

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ã®ç›£è¦–

**å®Ÿè£…**:
```typescript
// Redis çµ±è¨ˆã‚’å–å¾—
async function getCacheStats(): Promise<{
  hits: number;
  misses: number;
  hitRate: number;
}> {
  const info = await redis.info('stats');

  // Redis INFO ã‚³ãƒãƒ³ãƒ‰ã‹ã‚‰çµ±è¨ˆã‚’æŠ½å‡º
  const hits = parseInt(info.match(/keyspace_hits:(\d+)/)?.[1] || '0');
  const misses = parseInt(info.match(/keyspace_misses:(\d+)/)?.[1] || '0');
  const hitRate = hits / (hits + misses);

  return { hits, misses, hitRate };
}

// æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆã§ç¢ºèª
const stats = await getCacheStats();
console.log(`ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡: ${(stats.hitRate * 100).toFixed(2)}%`);
// ç›®æ¨™: 30% ä»¥ä¸Š
```

---

## ãƒãƒƒãƒå‡¦ç†

### åŸ‹ã‚è¾¼ã¿ãƒ™ã‚¯ãƒˆãƒ«ã®ç”Ÿæˆ

**éåŒæœŸå‡¦ç†**ï¼ˆãƒã‚±ãƒƒãƒˆä½œæˆæ™‚ï¼‰:
```typescript
// ãƒã‚±ãƒƒãƒˆä½œæˆæ™‚ã¯éåŒæœŸã§ãƒ™ã‚¯ãƒˆãƒ«ç”Ÿæˆ
export class TicketController {
  static createTicket = asyncHandler(async (req, res, next) => {
    // 1. ãƒã‚±ãƒƒãƒˆã‚’ä½œæˆï¼ˆåŒæœŸï¼‰
    const ticket = await TicketModel.create({ ... });

    // 2. åŸ‹ã‚è¾¼ã¿ãƒ™ã‚¯ãƒˆãƒ«ã‚’ç”Ÿæˆï¼ˆéåŒæœŸã€await ã—ãªã„ï¼‰
    VectorSearchService.generateAndSaveEmbedding(
      ticket.ticket_id,
      ticket.subject,
      ticket.description
    ).catch(error => {
      console.error('åŸ‹ã‚è¾¼ã¿ç”Ÿæˆã‚¨ãƒ©ãƒ¼:', error);
      // ã‚¨ãƒ©ãƒ¼ã¯è¨˜éŒ²ã™ã‚‹ãŒã€ãƒã‚±ãƒƒãƒˆä½œæˆã¯æˆåŠŸæ‰±ã„
    });

    // 3. å³åº§ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”å´ï¼ˆãƒ™ã‚¯ãƒˆãƒ«ç”Ÿæˆã‚’å¾…ãŸãªã„ï¼‰
    res.json({ success: true, data: ticket });
  });
}
```

**åŠ¹æœ**: ãƒã‚±ãƒƒãƒˆä½œæˆã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ãŒ 5ç§’ â†’ 0.5ç§’ ã«æ”¹å–„

---

### å¤œé–“ãƒãƒƒãƒå‡¦ç†

**ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `backend/scripts/generate-embeddings-batch.ts`

```typescript
async function generateEmbeddingsBatch() {
  // 1. æœªç”Ÿæˆã®ãƒã‚±ãƒƒãƒˆã‚’å–å¾—
  const tickets = await query(`
    SELECT t.ticket_id, t.subject, t.description
    FROM tickets t
    LEFT JOIN ticket_embeddings te
      ON t.ticket_id = te.ticket_id
      AND te.embedding_version = 'claude-sonnet-4-5-20250929'
    WHERE te.embedding_id IS NULL
      AND t.created_at >= CURRENT_DATE - INTERVAL '7 days'
    LIMIT 1000
  `);

  // 2. ãƒãƒƒãƒå‡¦ç†ï¼ˆ10ä»¶ãšã¤ã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–ï¼‰
  const batchSize = 10;
  for (let i = 0; i < tickets.rows.length; i += batchSize) {
    const batch = tickets.rows.slice(i, i + batchSize);

    await Promise.all(
      batch.map(ticket =>
        VectorSearchService.generateAndSaveEmbedding(
          ticket.ticket_id,
          ticket.subject,
          ticket.description
        )
      )
    );

    // ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–: 1ç§’å¾…æ©Ÿ
    await new Promise(resolve => setTimeout(resolve, 1000));
  }
}

// Cron ã§å®Ÿè¡Œ: æ¯æ—¥ åˆå‰2æ™‚
// 0 2 * * * cd /path/to/backend && ts-node scripts/generate-embeddings-batch.ts
```

---

### ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ›´æ–°

**ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `backend/scripts/update-ai-metrics-cache.ts`

```typescript
async function updateMetricsCache() {
  const today = new Date();
  const firstDayOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
  const lastDayOfMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0);

  // 1. ç²¾åº¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’é›†è¨ˆ
  const accuracyMetrics = {
    category: await AIService.getAccuracyMetrics('category', firstDayOfMonth, lastDayOfMonth),
    priority: await AIService.getAccuracyMetrics('priority', firstDayOfMonth, lastDayOfMonth),
    routing: await AIService.getAccuracyMetrics('routing', firstDayOfMonth, lastDayOfMonth),
  };

  // 2. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜
  await query(`
    SELECT update_ai_metrics_cache($1, $2, $3, $4)
  `, ['accuracy', firstDayOfMonth, lastDayOfMonth, JSON.stringify(accuracyMetrics)]);

  console.log('âœ… AIãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°å®Œäº†');
}

// Cron ã§å®Ÿè¡Œ: æ¯æœˆ1æ—¥ åˆå‰3æ™‚
// 0 3 1 * * cd /path/to/backend && ts-node scripts/update-ai-metrics-cache.ts
```

---

## ãƒ¬ãƒ¼ãƒˆåˆ¶é™

### ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ãƒ¬ãƒ¼ãƒˆåˆ¶é™

**å®Ÿè£…**: `backend/src/services/claude-api.client.ts`

```typescript
private async checkRateLimit(userId: string): Promise<void> {
  const now = Date.now();
  const windowMs = 60000;  // 1åˆ†
  const maxRequests = 10;  // 10å›/åˆ†

  // Redisãƒ™ãƒ¼ã‚¹ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ãƒã‚±ãƒƒãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼‰
  const key = `ai-rate-limit:${userId}`;
  const requests = await this.cache.incr(key);

  if (requests === 1) {
    // åˆå›ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«TTLè¨­å®š
    await this.cache.expire(key, 60);  // 60ç§’
  }

  if (requests > maxRequests) {
    const ttl = await this.cache.ttl(key);
    throw new Error(
      `AIæ©Ÿèƒ½ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ¶é™ï¼ˆ${maxRequests}å›/åˆ†ï¼‰ã‚’è¶…ãˆã¾ã—ãŸã€‚` +
      `ã‚ã¨ ${ttl} ç§’å¾…ã£ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚`
    );
  }
}
```

---

### ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¬ãƒ¼ãƒˆåˆ¶é™

**å®Ÿè£…**: Anthropic API ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã«å¯¾å¿œ

```typescript
// ãƒãƒƒã‚¯ã‚ªãƒ•æˆ¦ç•¥ï¼ˆExponential Backoffï¼‰
async function claudeAPIWithBackoff(
  fn: () => Promise<any>,
  maxRetries: number = 3
): Promise<any> {
  let lastError;

  for (let i = 0; i < maxRetries; i++) {
    try {
      return await fn();
    } catch (error: any) {
      lastError = error;

      // 429 ã‚¨ãƒ©ãƒ¼ã®å ´åˆã®ã¿ãƒªãƒˆãƒ©ã‚¤
      if (error.status === 429) {
        const waitTime = Math.pow(2, i) * 1000;  // 1ç§’, 2ç§’, 4ç§’
        console.log(`â³ ãƒ¬ãƒ¼ãƒˆåˆ¶é™æ¤œå‡ºã€${waitTime}ms å¾…æ©Ÿã—ã¦ãƒªãƒˆãƒ©ã‚¤...`);
        await new Promise(resolve => setTimeout(resolve, waitTime));
      } else {
        throw error;  // ãã®ä»–ã®ã‚¨ãƒ©ãƒ¼ã¯å³åº§ã«å†ã‚¹ãƒ­ãƒ¼
      }
    }
  }

  throw lastError;
}

// ä½¿ç”¨ä¾‹
const response = await claudeAPIWithBackoff(() =>
  this.client.messages.create({ ... })
);
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æœ€é©åŒ–

**å¿…é ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
```sql
-- ai_predictions ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE INDEX idx_ai_predictions_ticket ON ai_predictions(ticket_id);
CREATE INDEX idx_ai_predictions_type_accepted ON ai_predictions(prediction_type, was_accepted)
  WHERE was_accepted IS NOT NULL;

-- ticket_embeddings ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE INDEX idx_ticket_embeddings_combined_hnsw
  ON ticket_embeddings
  USING hnsw (combined_vector vector_cosine_ops)
  WITH (m = 24, ef_construction = 100);

-- ai_routing_logs ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE INDEX idx_ai_routing_ticket ON ai_routing_logs(ticket_id);
```

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½¿ç”¨çŠ¶æ³ã®ç¢ºèª**:
```sql
-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã‚¹ã‚­ãƒ£ãƒ³å›æ•°ã‚’ç¢ºèª
SELECT
  schemaname,
  tablename,
  indexname,
  idx_scan,
  idx_tup_read,
  idx_tup_fetch
FROM pg_stat_user_indexes
WHERE schemaname = 'public'
  AND tablename IN ('ai_predictions', 'ticket_embeddings', 'ai_routing_logs')
ORDER BY idx_scan DESC;
```

---

### ã‚¯ã‚¨ãƒªã®æœ€é©åŒ–

**Beforeï¼ˆé…ã„ï¼‰**:
```sql
-- ãƒ•ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœªä½¿ç”¨ï¼‰
SELECT *
FROM ai_predictions
WHERE ticket_id IN (
  SELECT ticket_id FROM tickets WHERE created_at >= '2025-01-01'
);
```

**Afterï¼ˆé«˜é€Ÿï¼‰**:
```sql
-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨
SELECT p.*
FROM ai_predictions p
JOIN tickets t ON p.ticket_id = t.ticket_id
WHERE t.created_at >= '2025-01-01'
  AND p.prediction_type = 'category';

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹: idx_ai_predictions_ticket, idx_tickets_created_at
```

---

### ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°ï¼ˆå¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿å‘ã‘ï¼‰

**ai_predictions ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°**:
```sql
-- æœˆæ¬¡ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°ï¼ˆ10ä¸‡ä»¶ä»¥ä¸Šã®ãƒã‚±ãƒƒãƒˆãŒã‚ã‚‹å ´åˆï¼‰
CREATE TABLE ai_predictions (
  -- æ—¢å­˜ã®å®šç¾©
) PARTITION BY RANGE (created_at);

-- 2025å¹´1æœˆã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³
CREATE TABLE ai_predictions_2025_01 PARTITION OF ai_predictions
  FOR VALUES FROM ('2025-01-01') TO ('2025-02-01');

-- 2025å¹´2æœˆã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³
CREATE TABLE ai_predictions_2025_02 PARTITION OF ai_predictions
  FOR VALUES FROM ('2025-02-01') TO ('2025-03-01');

-- ä»¥é™ã€æœˆæ¬¡ã§è‡ªå‹•ä½œæˆ
```

**åŠ¹æœ**: ã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒ 3-5å€ å‘ä¸Š

---

## ã‚³ã‚¹ãƒˆæœ€é©åŒ–

### Claude API ã‚³ã‚¹ãƒˆã®å‰Šæ¸›

#### 1. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®çŸ­ç¸®

**Beforeï¼ˆ3,500 tokensï¼‰**:
```typescript
const prompt = `
# åˆ©ç”¨å¯èƒ½ãªã‚«ãƒ†ã‚´ãƒªï¼ˆè©³ç´°èª¬æ˜ä»˜ãï¼‰
1. Microsoft 365 > Exchange Online
   èª¬æ˜: Microsoft Exchange Online ã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ™ãƒ¼ã‚¹ã®ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã§ã™...ï¼ˆ200å˜èªã®èª¬æ˜ï¼‰
2. Microsoft 365 > Teams
   èª¬æ˜: Microsoft Teams ã¯ã€ãƒãƒ£ãƒƒãƒˆã€ãƒ“ãƒ‡ã‚ªä¼šè­°ã€ãƒ•ã‚¡ã‚¤ãƒ«å…±æœ‰...ï¼ˆ200å˜èªã®èª¬æ˜ï¼‰
... ï¼ˆå…¨11ã‚«ãƒ†ã‚´ãƒªã€åˆè¨ˆ 2,200å˜èªï¼‰

# ãƒã‚±ãƒƒãƒˆå†…å®¹
ä»¶å: {subject}
è©³ç´°: {description}
`;
// Input tokens: ç´„ 3,500
```

**Afterï¼ˆ1,200 tokensï¼‰**:
```typescript
const prompt = `
# åˆ©ç”¨å¯èƒ½ãªã‚«ãƒ†ã‚´ãƒª
- Microsoft 365 > Exchange Onlineï¼ˆãƒ¡ãƒ¼ãƒ«ã€äºˆå®šè¡¨ï¼‰
- Microsoft 365 > Teamsï¼ˆãƒãƒ£ãƒƒãƒˆã€ä¼šè­°ï¼‰
... ï¼ˆç°¡æ½”ãªèª¬æ˜ã€åˆè¨ˆ 400å˜èªï¼‰

# ãƒã‚±ãƒƒãƒˆå†…å®¹
ä»¶å: {subject}
è©³ç´°: {description}
`;
// Input tokens: ç´„ 1,200
```

**å‰Šæ¸›ç‡**: 66%å‰Šæ¸› â†’ ã‚³ã‚¹ãƒˆ 66%å‰Šæ¸›

---

#### 2. ã‚­ãƒ£ãƒƒã‚·ãƒ¥TTLã®å»¶é•·

**è¨­å®š**:
```bash
# backend/.env

# é–‹ç™ºç’°å¢ƒ
AI_CACHE_TTL=3600  # 1æ™‚é–“

# æœ¬ç•ªç’°å¢ƒ
AI_CACHE_TTL=7200  # 2æ™‚é–“ï¼ˆã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼‰
```

**åŠ¹æœ**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ãŒ 30% â†’ 45% ã«å‘ä¸Š â†’ APIå‘¼ã³å‡ºã—ãŒ 15%å‰Šæ¸›

---

#### 3. maxTokens ã®æœ€é©åŒ–

**ç”¨é€”åˆ¥ã®è¨­å®š**:
```typescript
// ãƒã‚±ãƒƒãƒˆåˆ†é¡ï¼ˆçŸ­ã„ JSON å‡ºåŠ›ï¼‰
const response = await claudeClient.sendPrompt(prompt, systemPrompt, {
  maxTokens: 2048,  // 8192 â†’ 2048ï¼ˆ4åˆ†ã®1ï¼‰
});

// å›ç­”ææ¡ˆï¼ˆé•·æ–‡ç”Ÿæˆï¼‰
const response = await claudeClient.sendPrompt(prompt, systemPrompt, {
  maxTokens: 4096,
});

// ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆï¼ˆè¶…é•·æ–‡ï¼‰
const response = await claudeClient.sendPrompt(prompt, systemPrompt, {
  maxTokens: 8192,
});
```

**å‰Šæ¸›åŠ¹æœ**:
- ä¸è¦ãªå‡ºåŠ›ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å‰Šæ¸› â†’ Output ã‚³ã‚¹ãƒˆãŒ 50-75%å‰Šæ¸›

---

### æœˆæ¬¡ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Š

**ä½¿ç”¨é‡è¨ˆç®—**:
```typescript
// scripts/calculate-monthly-cost.ts

async function calculateMonthlyCost() {
  const startDate = new Date(2025, 0, 1);  // 2025-01-01
  const endDate = new Date(2025, 0, 31);   // 2025-01-31

  // ai_predictions ã‹ã‚‰ä½¿ç”¨ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã‚’é›†è¨ˆ
  const result = await query(`
    SELECT
      COUNT(*) as total_requests,
      SUM((rationale->>'input_tokens')::int) as total_input_tokens,
      SUM((rationale->>'output_tokens')::int) as total_output_tokens
    FROM ai_predictions
    WHERE created_at >= $1 AND created_at <= $2
  `, [startDate, endDate]);

  const { total_requests, total_input_tokens, total_output_tokens } = result.rows[0];

  // ã‚³ã‚¹ãƒˆè¨ˆç®—ï¼ˆSonnet 4.5 æ–™é‡‘ï¼‰
  const inputCost = (total_input_tokens / 1_000_000) * 3.00;   // $3.00/M
  const outputCost = (total_output_tokens / 1_000_000) * 15.00; // $15.00/M
  const totalCost = inputCost + outputCost;

  console.log('=== æœˆæ¬¡ã‚³ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆ ===');
  console.log(`æœŸé–“: ${startDate.toISOString()} ã€œ ${endDate.toISOString()}`);
  console.log(`ç·ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°: ${total_requests}`);
  console.log(`Input ãƒˆãƒ¼ã‚¯ãƒ³: ${total_input_tokens.toLocaleString()}`);
  console.log(`Output ãƒˆãƒ¼ã‚¯ãƒ³: ${total_output_tokens.toLocaleString()}`);
  console.log(`Input ã‚³ã‚¹ãƒˆ: $${inputCost.toFixed(2)}`);
  console.log(`Output ã‚³ã‚¹ãƒˆ: $${outputCost.toFixed(2)}`);
  console.log(`ç·ã‚³ã‚¹ãƒˆ: $${totalCost.toFixed(2)}`);
  console.log(`1ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚ãŸã‚Š: $${(totalCost / total_requests).toFixed(4)}`);

  // Slack é€šçŸ¥
  await sendSlackAlert(`ğŸ“Š AIæ©Ÿèƒ½æœˆæ¬¡ã‚³ã‚¹ãƒˆ: $${totalCost.toFixed(2)}`);
}
```

**å®Ÿè¡Œ**:
```bash
# æœˆåˆã«å®Ÿè¡Œ
ts-node scripts/calculate-monthly-cost.ts
```

---

## ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã¨ã‚¢ãƒ©ãƒ¼ãƒˆ

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®åé›†

**å®Ÿè£…**:
```typescript
// backend/src/services/ai.service.ts

static async classifyTicket(...): Promise<TicketClassificationResult> {
  const startTime = Date.now();

  try {
    // AIå‡¦ç†
    const response = await claudeClient.sendPrompt(...);

    const processingTime = Date.now() - startTime;

    // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’è¨˜éŒ²
    await query(`
      INSERT INTO performance_metrics (
        metric_type,
        value,
        created_at
      ) VALUES ($1, $2, CURRENT_TIMESTAMP)
    `, ['ai_classify_response_time', processingTime]);

    return result;
  } catch (error) {
    // ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’è¨˜éŒ²
    const processingTime = Date.now() - startTime;
    await logError('ai_classify_error', { processingTime, error });
    throw error;
  }
}
```

---

### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆ

**å®Ÿè£…**:
```typescript
// scripts/monitor-ai-performance.ts

async function monitorPerformance() {
  // éå»1æ™‚é–“ã®å¹³å‡ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ã‚’å–å¾—
  const result = await query(`
    SELECT AVG(processing_time_ms) as avg_time
    FROM ai_predictions
    WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL '1 hour'
  `);

  const avgTime = parseFloat(result.rows[0].avg_time);

  // 3ç§’ï¼ˆp90ç›®æ¨™ï¼‰ã‚’è¶…ãˆãŸå ´åˆã«ã‚¢ãƒ©ãƒ¼ãƒˆ
  if (avgTime > 3000) {
    await sendSlackAlert(
      `âš ï¸ AIæ©Ÿèƒ½ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ãŒé…å»¶ã—ã¦ã„ã¾ã™:
      å¹³å‡ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ : ${avgTime.toFixed(0)}msï¼ˆç›®æ¨™: 3000msä»¥å†…ï¼‰

      åŸå› ã®å¯èƒ½æ€§:
      - Claude API ã®é…å»¶
      - Redis ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å•é¡Œ
      - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®è² è·
      - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é…å»¶`
    );
  }
}

// Cron ã§å®Ÿè¡Œ: æ¯æ™‚
// 0 * * * * cd /path/to/backend && ts-node scripts/monitor-ai-performance.ts
```

---

### ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆGrafana æ¨å¥¨ï¼‰

**Prometheus ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**:
```typescript
// backend/src/services/metrics.service.ts

import { Registry, Counter, Histogram } from 'prom-client';

const register = new Registry();

// AIåˆ†é¡ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°
const aiClassifyCounter = new Counter({
  name: 'ai_classify_requests_total',
  help: 'Total number of AI classification requests',
  labelNames: ['status'],
  registers: [register],
});

// AIåˆ†é¡ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ 
const aiClassifyDuration = new Histogram({
  name: 'ai_classify_duration_seconds',
  help: 'AI classification response time in seconds',
  buckets: [0.5, 1, 2, 3, 5, 10],
  registers: [register],
});

// ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’è¨˜éŒ²
export function recordAIClassifyMetrics(status: 'success' | 'error', durationMs: number) {
  aiClassifyCounter.inc({ status });
  aiClassifyDuration.observe(durationMs / 1000);
}

// ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
app.get('/metrics', async (req, res) => {
  res.set('Content-Type', register.contentType);
  res.end(await register.metrics());
});
```

---

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. éåŒæœŸå‡¦ç†ã®æ´»ç”¨

**åŸå‰‡**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’æãªã‚ãªã„ç¯„å›²ã§éåŒæœŸåŒ–

```typescript
// Good âœ…: åŸ‹ã‚è¾¼ã¿ç”Ÿæˆã¯éåŒæœŸ
async function createTicket(data) {
  const ticket = await TicketModel.create(data);

  // éåŒæœŸå‡¦ç†ï¼ˆawait ã—ãªã„ï¼‰
  generateEmbedding(ticket).catch(console.error);

  return ticket;  // å³åº§ã«è¿”å´
}

// Bad âŒ: ã™ã¹ã¦ã‚’åŒæœŸå‡¦ç†
async function createTicket(data) {
  const ticket = await TicketModel.create(data);

  // åŒæœŸå‡¦ç†ï¼ˆ3-5ç§’å¾…æ©Ÿï¼‰
  await generateEmbedding(ticket);

  return ticket;  // é…å»¶
}
```

---

### 2. ä¸¦åˆ—å‡¦ç†ã®æ´»ç”¨

**åŸå‰‡**: ç‹¬ç«‹ã—ãŸã‚¿ã‚¹ã‚¯ã¯ä¸¦åˆ—å®Ÿè¡Œ

```typescript
// Good âœ…: ä¸¦åˆ—å‡¦ç†
async function classifyTicket(input) {
  const [categoriesResult, similarTicketsResult] = await Promise.all([
    query(`SELECT * FROM categories WHERE is_active = true`),
    query(`SELECT * FROM tickets WHERE subject ILIKE $1 LIMIT 5`, [`%${input.subject}%`]),
  ]);
  // å®Ÿè¡Œæ™‚é–“: max(query1, query2) â‰ˆ 0.5ç§’
}

// Bad âŒ: é€æ¬¡å‡¦ç†
async function classifyTicket(input) {
  const categoriesResult = await query(`SELECT * FROM categories WHERE is_active = true`);
  const similarTicketsResult = await query(`SELECT * FROM tickets WHERE subject ILIKE $1 LIMIT 5`, [`%${input.subject}%`]);
  // å®Ÿè¡Œæ™‚é–“: query1 + query2 â‰ˆ 1.0ç§’
}
```

---

### 3. ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒªãƒ³ã‚°

**è¨­å®š**: `backend/src/config/database.ts`

```typescript
import { Pool } from 'pg';

const pool = new Pool({
  host: process.env.DB_HOST,
  port: parseInt(process.env.DB_PORT || '5432'),
  database: process.env.DB_NAME,
  user: process.env.DB_USER,
  password: process.env.DB_PASSWORD,

  // ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ«è¨­å®š
  max: 20,              // æœ€å¤§æ¥ç¶šæ•°
  min: 2,               // æœ€å°æ¥ç¶šæ•°
  idleTimeoutMillis: 30000,  // ã‚¢ã‚¤ãƒ‰ãƒ«æ¥ç¶šã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
  connectionTimeoutMillis: 2000,  // æ¥ç¶šã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
});
```

**ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°**:
```typescript
// å®šæœŸçš„ã«ãƒ—ãƒ¼ãƒ«ã®çŠ¶æ…‹ã‚’ç¢ºèª
setInterval(() => {
  console.log('DB Pool Stats:', {
    total: pool.totalCount,
    idle: pool.idleCount,
    waiting: pool.waitingCount,
  });
}, 60000);  // 1åˆ†ã”ã¨
```

---

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

### ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆï¼ˆApache Benchï¼‰

**ãƒã‚±ãƒƒãƒˆåˆ†é¡API:**
```bash
# ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™
cat > request.json <<EOF
{
  "subject": "Outlookã§æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒé€ä¿¡ã§ããªã„",
  "description": "5MBã®PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’é€ä¿¡ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™",
  "requester_id": "user-uuid"
}
EOF

# ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ: 100ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€10ä¸¦è¡Œ
ab -n 100 -c 10 \
   -H "Authorization: Bearer $TOKEN" \
   -H "Content-Type: application/json" \
   -p request.json \
   -T application/json \
   http://localhost:3000/api/ai/classify-ticket

# æœŸå¾…ã•ã‚Œã‚‹çµæœ:
# - Requests per second: 3-5 req/s
# - Time per request (mean): 2000-3000ms
# - 50% ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒ 2500ms ä»¥å†…
# - 90% ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒ 3500ms ä»¥å†…
```

---

### ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆk6ï¼‰

**ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `tests/load/ai-classify.js`

```javascript
import http from 'k6/http';
import { check, sleep } from 'k6';

export const options = {
  stages: [
    { duration: '30s', target: 10 },   // 10ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¾ã§ä¸Šæ˜‡
    { duration: '1m', target: 10 },    // 10ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç¶­æŒ
    { duration: '30s', target: 0 },    // 0ã«ä¸‹é™
  ],
  thresholds: {
    http_req_duration: ['p(90)<3000'],  // p90 < 3ç§’
    http_req_failed: ['rate<0.01'],     // ã‚¨ãƒ©ãƒ¼ç‡ < 1%
  },
};

export default function () {
  const payload = JSON.stringify({
    subject: 'Outlookã§æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒé€ä¿¡ã§ããªã„',
    description: '5MBã®PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’é€ä¿¡ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™',
    requester_id: 'user-uuid',
  });

  const response = http.post(
    'http://localhost:3000/api/ai/classify-ticket',
    payload,
    {
      headers: {
        'Authorization': `Bearer ${__ENV.TOKEN}`,
        'Content-Type': 'application/json',
      },
    }
  );

  check(response, {
    'status is 200': (r) => r.status === 200,
    'response time < 3s': (r) => r.timings.duration < 3000,
    'has predictions': (r) => JSON.parse(r.body).data.predictions !== undefined,
  });

  sleep(1);
}
```

**å®Ÿè¡Œ**:
```bash
k6 run tests/load/ai-classify.js

# å‡ºåŠ›ä¾‹:
# scenarios: (100.00%) 1 scenario, 10 max VUs, 2m30s max duration
# âœ“ status is 200
# âœ“ response time < 3s
# âœ“ has predictions
# http_req_duration..........: avg=2.45s  p(90)=2.95s  p(99)=3.12s
# http_req_failed............: 0.00% âœ“ 0 âœ— 100
```

---

## ç¶™ç¶šçš„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„

### æœˆæ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹

**Week 1: ãƒ‡ãƒ¼ã‚¿åé›†**
```bash
# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’å–å¾—
ts-node scripts/generate-performance-report.ts --month 2025-01
```

**Week 2: ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ç‰¹å®š**
```sql
-- æœ€ã‚‚é…ã„ã‚¯ã‚¨ãƒªã‚’ç‰¹å®š
SELECT
  prediction_type,
  ROUND(AVG(processing_time_ms), 0) as avg_ms,
  ROUND(PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY processing_time_ms), 0) as p90_ms,
  MAX(processing_time_ms) as max_ms
FROM ai_predictions
WHERE created_at >= CURRENT_DATE - INTERVAL '30 days'
GROUP BY prediction_type
ORDER BY avg_ms DESC;
```

**Week 3: æœ€é©åŒ–å®Ÿæ–½**
- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆçŸ­ç¸®
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¿½åŠ 
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥TTLèª¿æ•´

**Week 4: åŠ¹æœæ¸¬å®š**
```sql
-- æ”¹å–„å‰å¾Œã®æ¯”è¼ƒ
SELECT
  DATE_TRUNC('week', created_at) as week,
  ROUND(AVG(processing_time_ms), 0) as avg_ms
FROM ai_predictions
WHERE created_at >= CURRENT_DATE - INTERVAL '60 days'
GROUP BY week
ORDER BY week;
```

---

## ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ãƒ‡ãƒ—ãƒ­ã‚¤å‰

- [ ] Redis ãŒèµ·å‹•ã—ã¦ã„ã‚‹
- [ ] pgvector ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ013, 014, 015ï¼‰ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹
- [ ] ç’°å¢ƒå¤‰æ•°ï¼ˆCLAUDE_API_KEY, REDIS_URLï¼‰ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆãŒåˆæ ¼ã—ã¦ã„ã‚‹ï¼ˆp90 < 3ç§’ï¼‰
- [ ] ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ãŒ 30% ä»¥ä¸Š

### æœ¬ç•ªé‹ç”¨ä¸­

- [ ] æ—¥æ¬¡ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ç¢ºèª
- [ ] é€±æ¬¡ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ã‚’ç¢ºèª
- [ ] æœˆæ¬¡ã§ã‚³ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ
- [ ] æœˆæ¬¡ã§ VACUUM ANALYZE ã‚’å®Ÿè¡Œ
- [ ] å››åŠæœŸã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¦‹ç›´ã—

---

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

- [README.md](./README.md) - AIæ©Ÿèƒ½é–‹ç™ºè€…ã‚¬ã‚¤ãƒ‰ã®ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸
- [01_AIæ©Ÿèƒ½æ¦‚è¦.md](./01_AIæ©Ÿèƒ½æ¦‚è¦.md) - ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å…¨ä½“åƒ

---

**æœ€çµ‚æ›´æ–°:** 2026å¹´2æœˆ
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³:** 1.0.0
